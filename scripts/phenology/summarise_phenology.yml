script: summarise_phenology.py
name: Summarise phenology
timeout: 1440
author: 
  - name: Jory Griffith
license: CC-BY
description: "Summarise yearly phenology data for a country (Europe only) using the copernicus data space ecosystem phenology layer. The script uses the openEO python client to send a job to openEO. The raster has values for the Plant Phenology Index (PPI), which is a vegetation index that helps estimate vegetation health and photosyntehtic activity throughout the growing eason. It is more directly related to plant phenology compared to other vegetation indices like NDVI, and does not saturate in high biomass conditions. It is computed with near infrared reflectance, which is strongly reflected by healthy vegetation. You can read more about the phenology layers at https://land.copernicus.eu/en/dataset-catalog."
inputs:
  bbox:
    label: bbox
    description: Vector of float, bbox coordinates of the extent in the order xmin, ymin, xmax, ymax
    type: float[]
    example: null
  study_area_polygon:
    label: Polygon of study area
    description: Polygon of the study area of interest
    type: application/geo+json
    example: null
  start_date:
    label: Start date
    description: Start date for phenology time series
    type: text
    example: "2017"
  end_date:
    label: End date
    description: End date for phenology time series
    type: text
    example: "2023"
  bands:
    label: Bands
    description: "Bands of interest for the calculations. Start of season date (SOSD) - date when the vegetation growing season starts, when the PPI value reaches 25% of the season amplitude during the green-up period.
    End of season date (EOSD) - the date when the vegetation growing season ends in the time profile of the PPI. Occurs when the PPI value reaches 15% of the season ampltitude during the green-down period.
    Start of season value (SOSV) - the value of the PPI at the start of the vegetation growing season
    End of season value (EOSV) - the value of the PPI at the end of the vegetation growing season
    Season maximum value (MAXV) - the maximum (peak) value that the PPI reaches during the vegetation growing season
    Season maximum date (MAXD) - date in the vegetation growing season where the mximum PPI is reached
    Season minimum value (MINV) - average PPI of minima of left adn right sides of each season
    Season amplitude (AMPL) - difference between the maximum and minimum PPI values reached during the season
    Season length (LENGTH) - number of days between the start and end dates of the vegetation growing season
    Slope of the green-up period (LSLOPE) - the rate of change in the values of PPI at the day when the vegetation growing season starts
     Slope of the green-down period (RSLOPE) - the rate of change in tha values of PPO at the dat when the vegetatio growing season ends
    Seasonal productivity (SPROD) - growing season integral computed as sum of all daily PPI values between the dates of the season start and end, minus their base level.
    Total productivity (TPROD) - the growing season integral computed as sum of all daily PPI values between the dates of the season start and end
    Quality flag (QFLAG) - quality indicator assisting users with the screening of clouds, shadows from clouds and topography, other dark areas, snow and water surfaces in their analysis of the PPI dataset"
    type: options[]
    options: 
      - "SOSD"
      - "EOSD"
      - "SOSV"
      - "EOSV"
      - "MAXD"
      - "MAXV"
      - "MINV"
      - "AMPL"
      - "LENGTH"
      - "LSLOPE"
      - "RSLOPE"
      - "SPROD"
      - "TPROD"
      - "QFLAG"
    example: ["LENGTH", "AMPL"]
  aggregate_function:
    label: Aggregate function
    description: Function to spatially aggregate by
    type: options
    options:
      - mean
      - min
      - max
    example: mean
  spatial_resolution:
    label: Spatial resolution
    description: Spatial resolution, in meters, of the raster for plotting, leave blank to have the original spatial resolution of the layer.
    type: int
    example: null
outputs:
  rasters:
    label: Phenology rasters
    description: Rasters of phenology layers over time
    type: image/tiff;application=geotiff[]
  timeseries:
    label: Zonal statistics
    description: Summarised values over the polygon of interest for each year for each band of interest
    type: text/csv
conda:
  channels:
    - conda-forge
  dependencies:
    - openeo
    - pandas