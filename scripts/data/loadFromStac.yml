script: loadFromStac.R
name: Load from STAC
description: "Extract individual unprocessed items from various collections on the GEO BON STAC catalog."
author:
  - name: Guillaume Larocque
    identifier: https://orcid.org/0000-0002-5967-9156
  - name: Jory Griffith
    email: jory.griffith@mcgill.ca
    identifier: https://orcid.org/0000-0001-6020-6690
inputs:
  stac_url:
    label: STAC URL
    description: URL of the STAC catalog.
    type: text
    example: https://stac.geobon.org/
  bbox:
    label: Bounding box
    description: Vector of float, bbox coordinates of the extent in the order xmin, ymin, xmax, ymax
    type: float[]
    example: [-831089, 117211, 783872, 2103311]
  collections_items:
    label: STAC collection items
    description: Vector of strings. To pull specific collection items, input the collection name followed by '|' followed by item id (e.g. "chelsa-clim|bio1").
      To extract a whole collection, type the collection name only (e.g. "chelsa-clim"). To pull collection items by date, write the collection name and
      provide a start date, end date, and temporal resolution.
    type: text[]
    example: ["chelsa-clim|bio1", "chelsa-clim|bio2"]
  t0:
    label: Start date
    description: Start date for time series layers. Can be in the format YYYY or YYYY-MM-DD. Leave blank if extracting items by name.
    type: text
    example: NULL
  t1:
    label: End date
    description: End date for time series layers. Can be in the format YYYY or YYYY-MM-DD. Leave blank if extracting items by name.
    type: text
    example: NULL
  temporal_res:
    label: Temporal resolution
    description: Temporal resolution to use when querying STAC items by date, in the format ("P", time interval, and time unit, e.g.
      "P1Y" is yearly, "P1M" is montly, and "P1D" is daily). Leave blank if not querying by date. If the temporal resolution is
      coarser than the temporal resolution of the time series, the layers will be aggregated with the aggregation method chosen below.
    type: text
    example: NULL
  crs:
    label: Coordinate reference system
    description: |
      Numerical value referring to the coordinate reference system
    type: text
    example: "EPSG:6624"
  spatial_res:
    label: Spatial resolution
    description: Integer, spatial resolution of the rasters in the same units as the coordinate reference system
      (meters for projected reference systems and degrees for reference systems in lat long).
    type: float
    example: 1000.0
  resampling:
    label: Resampling method
    description: Resampling method used when rescaling and/or reprojecting the raster layers.
      See [gdalwarp](https://gdal.org/en/latest/programs/gdalwarp.html) for description.
    type: options
    options:
      - near
      - bilinear
      - average
      - mode
      - cubic
      - cubicspline
      - lanczos
      - rms
      - min
      - max
      - sum
      - med
      - q1
      - q3
    example: near
  aggregation:
    label: Aggregation method
    description: Method used to aggregate items when layers combining over time.
    type: options
    options:
      - first
      - min
      - max
      - mean
      - median
    example: first
  study_area:
    label: Study area
    description: Polygon of study area used to mask output layers, in geopackage format.
    type: application/geopackage+sqlite3
    example: null
outputs:
  rasters:
    label: Rasters
    description: Output raster files in geotiff format.
    type: image/tiff;application=geotiff[]

conda:
  channels:
    - conda-forge
    - r
  dependencies:
    - libgdal
    - r-lubridate
    - proj
    - r-proj
    - r-gdalcubes=0.7.1
    - r-rstac
    - r-dplyr
    - r-rcurl
    - r-rjson
    - r-sf
    - r-stars
    - r-terra
