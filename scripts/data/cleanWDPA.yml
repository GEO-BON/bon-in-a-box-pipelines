# For review PR
script: cleanWDPA.R
name: Clean protected areas from WDPA API
description: |
  This script cleans geometry issues in WDPA data and allows the user to filter based on the following criteria:
  - protected area legal status types (designated, inscribed, established)
  - inclusion of UNESCO Biosphere reserves
  - inclusion of marine protected areas
  - inclusion of areas with other effective area-based conservation measures (OECMs)
  - inclusion of protected areas represented as points
  - study area of interest
author:
  - name: Jory Griffith
    email: jory.griffith@mcgill.ca
    identifier: https://orcid.org/0000-0001-6020-6690
lifecycle:
  status: reviewed
inputs:
  study_area_polygon:
    label: Study area polygon
    description: |
      Study area of interest in a GeoPackage file.
    type: application/geopackage+sqlite3
    example: null
  protected_area_file:
    label: Protected areas file
    description: >
      Optional, additionnal user-provided protected areas in GeoPackage format.
      When left blank, the script will only use the protected areas from WDPA.
    type: application/geopackage+sqlite3
    example: null
  crs:
    label: CRS
    description: Object containing CRS.
    type: bboxCRS
    example:
  status_type:
    label: PA legal status types to include
    description: |
      Legal status types of protected areas to include.

      **Proposed:** The site is in the process of gaining recognition through legal or other effective means. It may still be managed as a protected area during this process. 

      **Inscribed:** Protected areas designated under the UNESCO World Heritage Convention.

      **Adopted:** Specially protected areas of marine importance (SPAMI) created under the Barcelona convention, 
      focusing on the protection of the marine environment and coastal region of the mediterranean.

      **Designated:** The site is legally recognized as a protected area. This implies specific binding commitment to
      conservation in the long term. 

      **Established:** The site is recognized as protected area through other effective means. This implies long-term commitment to conservation, but without legal recognition.
    type: options[]
    options:
      - Proposed
      - Inscribed
      - Adopted
      - Designated
      - Established
    example: ["Proposed", "Inscribed", "Adopted", "Designated", "Established"]
  include_unesco:
    label: Include UNESCO Biosphere reserves
    description: >
      Check to include UNESCO Biosphere reserves. These serve as learning sites for sustainable development
      and combine biodiversity conservation with the sustainable use of natural resources and sustainable development.
      They may not be legally protected and may not be fully conserved, because they are often used for development or
      human settlement.


      Excluding these will limit the dataset to meeting stricter conservation standards.
    type: boolean
    example: TRUE
  buffer_points:
    label: Include protected area points
    description: >
      Check to include protected area represented by points. These protected areas are reported as a single point rather than a polygon.
      If checked, this will create a circular protected area around the reported point that is equal to the reported area.
      If left unchecked, all protected areas represented as points will be removed.


      Protected area points with no reported area will be removed in all cases.
    type: boolean
    example: TRUE
  include_marine:
    label: Include marine protected areas
    description: >
      Check to include marine protected areas.


      Note that the analysis is still limited to the bounds of the studyarea polygon.
      The chosen polygon needs to exceed the country land boundaries in order to really include marine protected areas.
    type: boolean
    example: FALSE
  include_oecm:
    label: Include OECMs
    description: >
      Check to include areas with other effective area-based conservation measures (OECMs). These are not officially designated
      protected areas but are still achieving conservation outcomes.
    type: boolean
    example: TRUE
outputs:
  study_area_clean:
    label: Study area
    description: Study area with fixed geometry
    type: application/geopackage+sqlite3
  protected_areas_clean:
    label: Polygon of protected areas
    description: Map of the protected areas in GeoPackage format, cleaned and filtered according to the input criteria.
    type: application/geopackage+sqlite3
conda:
  channels:
    - conda-forge
    - r
  dependencies:
    - r-rjson
    - r-sf
    - r-lwgeom
    - r-remotes
    - r-dplyr
    - r-lubridate
