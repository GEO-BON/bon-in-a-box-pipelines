{
  "nodes": [
    {
      "id": "3",
      "type": "io",
      "position": {
        "x": 801,
        "y": 118.33333333333337
      },
      "data": {
        "descriptionFile": "data>loadFromStac.yml"
      }
    },
    {
      "id": "4",
      "type": "constant",
      "position": {
        "x": 99,
        "y": 319.83333333333337
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": "https://stac.geobon.org/"
      }
    },
    {
      "id": "9",
      "type": "io",
      "position": {
        "x": 1998,
        "y": 108.33333333333337
      },
      "data": {
        "descriptionFile": "SHI>habitatChange_ESA.yml"
      }
    },
    {
      "id": "11",
      "type": "io",
      "position": {
        "x": 1284,
        "y": 374.33333333333337
      },
      "data": {
        "descriptionFile": "data>getAreaOfHabitat.yml"
      }
    },
    {
      "id": "12",
      "type": "io",
      "position": {
        "x": -71.3378224465323,
        "y": 382.8235550499227
      },
      "data": {
        "descriptionFile": "data>getCountryPolygon.yml"
      }
    },
    {
      "id": "14",
      "type": "io",
      "position": {
        "x": 658,
        "y": 807.3333333333334
      },
      "data": {
        "descriptionFile": "data>getRangeMap.yml"
      }
    },
    {
      "id": "15",
      "type": "userInput",
      "position": {
        "x": 249,
        "y": 788.5833333333334
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text[]",
        "value": [
          "Myrmecophaga tridactyla"
        ]
      }
    },
    {
      "id": "16",
      "type": "io",
      "position": {
        "x": 801,
        "y": 435.33333333333337
      },
      "data": {
        "descriptionFile": "data>loadFromStac.yml"
      }
    },
    {
      "id": "17",
      "type": "constant",
      "position": {
        "x": 89,
        "y": 551.5833333333334
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text[]",
        "value": [
          "earthenv_topography|elevation_min",
          "earthenv_topography|elevation_max"
        ]
      }
    },
    {
      "id": "23",
      "type": "userInput",
      "position": {
        "x": 1688,
        "y": 119.33333333333337
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "int[]",
        "value": []
      }
    },
    {
      "id": "26",
      "type": "output",
      "position": {
        "x": 642,
        "y": 749.3333333333334
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "33",
      "type": "userInput",
      "position": {
        "x": 120,
        "y": 481.58333333333337
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "options",
        "value": "first",
        "options": [
          "first",
          "min",
          "max",
          "mean",
          "median"
        ]
      }
    },
    {
      "id": "35",
      "type": "userInput",
      "position": {
        "x": 176,
        "y": 361.83333333333337
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "float",
        "value": 1000
      }
    },
    {
      "id": "36",
      "type": "userInput",
      "position": {
        "x": 125,
        "y": 446.58333333333337
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "options",
        "value": "near",
        "options": [
          "near",
          "bilinear",
          "average",
          "mode",
          "cubic",
          "cubicspline",
          "lanczos",
          "rms",
          "min",
          "max",
          "sum",
          "med",
          "q1",
          "q3"
        ]
      }
    },
    {
      "id": "40",
      "type": "output",
      "position": {
        "x": 1284,
        "y": 861.8333333333334
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "42",
      "type": "output",
      "position": {
        "x": 2654,
        "y": 287.33333333333337
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "43",
      "type": "io",
      "position": {
        "x": 2654,
        "y": 334.33333333333337
      },
      "data": {
        "descriptionFile": "SHI>calculateSHI.yml"
      }
    },
    {
      "id": "48",
      "type": "constant",
      "position": {
        "x": 99,
        "y": 662.5833333333334
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "49",
      "type": "constant",
      "position": {
        "x": 99,
        "y": 704.5833333333334
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "51",
      "type": "constant",
      "position": {
        "x": 99,
        "y": 746.5833333333334
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "52",
      "type": "userInput",
      "position": {
        "x": 217,
        "y": 165.83333333333337
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": "P1Y"
      }
    },
    {
      "id": "53",
      "type": "userInput",
      "position": {
        "x": 244,
        "y": 54
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "54",
      "type": "userInput",
      "position": {
        "x": 250,
        "y": 89
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "55",
      "type": "constant",
      "position": {
        "x": 89,
        "y": 12
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text[]",
        "value": [
          "esacci-lc"
        ]
      }
    },
    {
      "id": "56",
      "type": "userInput",
      "position": {
        "x": 92,
        "y": 276.33333333333337
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "bboxCRS"
      }
    },
    {
      "id": "57",
      "type": "output",
      "position": {
        "x": 3243,
        "y": 398.83333333333337
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "58",
      "type": "userInput",
      "position": {
        "x": 87.08214574158444,
        "y": 214.4577063984165
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "application/geopackage+sqlite3"
      }
    }
  ],
  "edges": [
    {
      "source": "4",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "stac_url",
      "id": "reactflow__edge-4-3stac_url"
    },
    {
      "source": "3",
      "sourceHandle": "rasters",
      "target": "9",
      "targetHandle": "layers",
      "id": "reactflow__edge-3rasters-9layers"
    },
    {
      "source": "11",
      "sourceHandle": "r_area_of_habitat",
      "target": "9",
      "targetHandle": "aoh",
      "id": "reactflow__edge-11r_area_of_habitat-9aoh"
    },
    {
      "source": "12",
      "sourceHandle": "country_region_polygon",
      "target": "11",
      "targetHandle": "country_region_polygon",
      "id": "reactflow__edge-12country_region_polygon-11country_region_polygon"
    },
    {
      "source": "15",
      "sourceHandle": null,
      "target": "14",
      "targetHandle": "species",
      "id": "reactflow__edge-15-14species"
    },
    {
      "source": "15",
      "sourceHandle": null,
      "target": "11",
      "targetHandle": "species",
      "id": "reactflow__edge-15-11species"
    },
    {
      "source": "14",
      "sourceHandle": "sf_range_map",
      "target": "11",
      "targetHandle": "sf_range_map",
      "id": "reactflow__edge-14sf_range_map-11sf_range_map"
    },
    {
      "source": "4",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "stac_url",
      "id": "reactflow__edge-4-16stac_url"
    },
    {
      "source": "16",
      "sourceHandle": "rasters",
      "target": "11",
      "targetHandle": "rasters",
      "id": "reactflow__edge-16rasters-11rasters"
    },
    {
      "source": "17",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "collections_items",
      "id": "reactflow__edge-17-16collections_items"
    },
    {
      "source": "23",
      "sourceHandle": null,
      "target": "9",
      "targetHandle": "habitats",
      "id": "reactflow__edge-23-9habitats"
    },
    {
      "source": "33",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "aggregation",
      "id": "reactflow__edge-33-16aggregation"
    },
    {
      "source": "33",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "aggregation",
      "id": "reactflow__edge-33-3aggregation"
    },
    {
      "source": "35",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "spatial_res",
      "id": "reactflow__edge-35-16spatial_res"
    },
    {
      "source": "35",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "spatial_res",
      "id": "reactflow__edge-35-3spatial_res"
    },
    {
      "source": "36",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "resampling",
      "id": "reactflow__edge-36-16resampling"
    },
    {
      "source": "36",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "resampling",
      "id": "reactflow__edge-36-3resampling"
    },
    {
      "source": "15",
      "sourceHandle": null,
      "target": "26",
      "targetHandle": null,
      "id": "reactflow__edge-15-26"
    },
    {
      "source": "14",
      "sourceHandle": "sf_range_map",
      "target": "40",
      "targetHandle": null,
      "id": "reactflow__edge-14sf_range_map-40"
    },
    {
      "source": "9",
      "sourceHandle": "raster",
      "target": "42",
      "targetHandle": null,
      "id": "reactflow__edge-9raster-42"
    },
    {
      "source": "9",
      "sourceHandle": "df_shs_tidy",
      "target": "43",
      "targetHandle": "df_shs_tidy",
      "id": "reactflow__edge-9df_shs_tidy-43df_shs_tidy"
    },
    {
      "source": "11",
      "sourceHandle": "df_aoh_areas",
      "target": "43",
      "targetHandle": "df_aoh_areas",
      "id": "reactflow__edge-11df_aoh_areas-43df_aoh_areas"
    },
    {
      "source": "35",
      "sourceHandle": null,
      "target": "11",
      "targetHandle": "spat_res",
      "id": "reactflow__edge-35-11spat_res"
    },
    {
      "source": "48",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "t0",
      "id": "reactflow__edge-48-16t0"
    },
    {
      "source": "49",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "t1",
      "id": "reactflow__edge-49-16t1"
    },
    {
      "source": "51",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "temporal_res",
      "id": "reactflow__edge-51-16temporal_res"
    },
    {
      "source": "52",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "temporal_res",
      "id": "reactflow__edge-52-3temporal_res"
    },
    {
      "source": "53",
      "sourceHandle": null,
      "target": "9",
      "targetHandle": "start_year",
      "id": "reactflow__edge-53-9start_year"
    },
    {
      "source": "53",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "t0",
      "id": "reactflow__edge-53-3t0"
    },
    {
      "source": "54",
      "sourceHandle": null,
      "target": "9",
      "targetHandle": "end_year",
      "id": "reactflow__edge-54-9end_year"
    },
    {
      "source": "54",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "t1",
      "id": "reactflow__edge-54-3t1"
    },
    {
      "source": "55",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "collections_items",
      "id": "reactflow__edge-55-3collections_items"
    },
    {
      "source": "56",
      "sourceHandle": null,
      "target": "12",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-56-12bbox_crs"
    },
    {
      "source": "56",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-56-3bbox_crs"
    },
    {
      "source": "56",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-56-16bbox_crs"
    },
    {
      "source": "56",
      "sourceHandle": null,
      "target": "11",
      "targetHandle": "crs",
      "id": "reactflow__edge-56-11crs"
    },
    {
      "source": "43",
      "sourceHandle": "df_shi",
      "target": "57",
      "targetHandle": null,
      "id": "reactflow__edge-43df_shi-57"
    },
    {
      "source": "43",
      "sourceHandle": "img_shi_timeseries",
      "target": "57",
      "targetHandle": null,
      "id": "reactflow__edge-43img_shi_timeseries-57"
    },
    {
      "source": "43",
      "sourceHandle": "img_w_shi_timeseries",
      "target": "57",
      "targetHandle": null,
      "id": "reactflow__edge-43img_w_shi_timeseries-57"
    },
    {
      "source": "9",
      "sourceHandle": "habitat_change_map",
      "target": "42",
      "targetHandle": null,
      "id": "reactflow__edge-9habitat_change_map-42"
    },
    {
      "source": "9",
      "sourceHandle": "shs_timeseries",
      "target": "42",
      "targetHandle": null,
      "id": "reactflow__edge-9shs_timeseries-42"
    },
    {
      "source": "9",
      "sourceHandle": "df_shs",
      "target": "42",
      "targetHandle": null,
      "id": "reactflow__edge-9df_shs-42"
    },
    {
      "source": "58",
      "sourceHandle": null,
      "target": "3",
      "targetHandle": "study_area",
      "id": "reactflow__edge-58-3study_area"
    },
    {
      "source": "58",
      "sourceHandle": null,
      "target": "16",
      "targetHandle": "study_area",
      "id": "reactflow__edge-58-16study_area"
    },
    {
      "source": "58",
      "sourceHandle": null,
      "target": "11",
      "targetHandle": "study_area",
      "id": "reactflow__edge-58-11study_area"
    }
  ],
  "inputs": {
    "pipeline@15": {
      "label": "Species",
      "description": "Scientific name of the species. Multiple species names can be specified, separated with a comma.",
      "type": "text[]",
      "example": [
        "Alces alces",
        "Ambystoma laterale"
      ],
      "weight": 0
    },
    "pipeline@56": {
      "label": "Bounding box and CRS",
      "description": "Select a country/region and a CRS to obtain the associated bounding box.",
      "type": "bboxCRS",
      "example": null,
      "weight": 1
    },
    "data>getAreaOfHabitat.yml@11|buff_size": {
      "description": "Size of the buffer around the study area. If it is not defined it will be estimated as half of the total width of the study area.",
      "label": "Buffer for study area",
      "type": "int",
      "example": 0,
      "weight": 2
    },
    "pipeline@53": {
      "label": "Start year",
      "description": "First time point for the land cover loss analysis.",
      "type": "text",
      "example": "2000",
      "weight": 3
    },
    "pipeline@54": {
      "label": "End year",
      "description": "Second time point for the land cover loss analysis.",
      "type": "text",
      "example": "2020",
      "weight": 4
    },
    "pipeline@52": {
      "label": "Time interval",
      "description": "Time interval of the analysis. (End year - start year)",
      "type": "text",
      "example": "P20Y",
      "weight": 5
    },
    "pipeline@23": {
      "label": "Habitats",
      "description": "Codes for the habitat types of the species of interest. For habitat types and their associated codes, refer to the [list of global CCI-LC codes](http://maps.elie.ucl.ac.be/CCI/viewer/download/CCI-LC_Maps_Legend.pdf).",
      "type": "int[]",
      "example": [
        "50",
        "60",
        "70",
        "80",
        "90",
        "151",
        "160",
        "170"
      ],
      "weight": 6
    },
    "data>getAreaOfHabitat.yml@11|range_map_type": {
      "description": "Select type of range map according to the type of the source file: 1) polygon, 2) raster, 3) an intersection between the raster and polygon files.",
      "label": "Type of range map",
      "type": "options",
      "options": [
        "Polygon",
        "Raster",
        "Both"
      ],
      "example": "Polygon",
      "weight": 7
    },
    "data>getAreaOfHabitat.yml@11|r_range_map": {
      "description": "Binary raster with expected area for the species or raster with values equal to 1 where the species is distributed and the rest is empty.",
      "label": "Range map (raster)",
      "type": "image/tiff;application=geotiff[]",
      "example": [],
      "weight": 8
    },
    "data>getAreaOfHabitat.yml@11|elevation_filter": {
      "description": "If 'yes' an elevation filter using IUCN information is applied, if 'no' the range map is taken as the area of habitat.",
      "label": "Filter by elevation",
      "type": "options",
      "options": [
        "Yes",
        "No"
      ],
      "example": "Yes",
      "weight": 9
    },
    "data>getAreaOfHabitat.yml@11|elev_buffer": {
      "description": "Elevation buffer in meters to add (or substract) to the reported species elevation range. Default is zero. Positive values will increase the range in that value in meters and negative values will reduce the range in that value.",
      "label": "Elevation buffer",
      "type": "int",
      "example": null,
      "weight": 10
    },
    "data>getRangeMap.yml@14|expert_source": {
      "description": "Source of the expert range map for the species. The options are:\nMap of Life (MOL), International union for conservation of nature (IUCN) and range maps from the Ministère de l’Environnement du Québec (QC).\n",
      "label": "Source of expert range map",
      "type": "options",
      "options": [
        "MOL",
        "IUCN",
        "QC"
      ],
      "example": "IUCN",
      "weight": 11
    },
    "pipeline@33": {
      "label": "Aggregation method",
      "description": "Method used to aggregate items that overlay each other",
      "type": "options",
      "example": "first",
      "options": [
        "first",
        "min",
        "max",
        "mean",
        "median"
      ],
      "weight": 12
    },
    "pipeline@35": {
      "label": "Spatial resolution",
      "description": "Integer, spatial resolution of the rasters in meters.",
      "type": "float",
      "example": 1000,
      "weight": 13
    },
    "pipeline@36": {
      "label": "Resampling method",
      "description": "Resampling method used when rescaling the raster layers from the STAC catalogue. See [gdalwarp](https://gdal.org/en/latest/programs/gdalwarp.html) for description.",
      "type": "options",
      "example": "near",
      "options": [
        "near",
        "bilinear",
        "average",
        "mode",
        "cubic",
        "cubicspline",
        "lanczos",
        "rms",
        "min",
        "max",
        "sum",
        "med",
        "q1",
        "q3"
      ],
      "weight": 14
    },
    "pipeline@58": {
      "label": "Study area",
      "description": "Polygon of study area used to mask output layers, in geopackage format.",
      "type": "application/geopackage+sqlite3",
      "example": null,
      "weight": 15
    }
  },
  "outputs": {
    "pipeline@15|default_output": {
      "label": "Species",
      "description": "Scientific name of the species. Multiple species names can be specified, separated with a comma.",
      "example": [
        "Alces alces",
        "Ambystoma laterale"
      ],
      "type": "text[]",
      "weight": 0
    },
    "SHI>habitatChange_ESA.yml@9|shs_timeseries": {
      "description": "Figure showing a time series of SHS values for each species.",
      "label": "SHS time series",
      "type": "image/png[]",
      "weight": 1
    },
    "SHI>habitatChange_ESA.yml@9|df_shs": {
      "description": "A TSV file containing Area Score, Connectivity Score, and SHS by time step for each species. Percentage of change, 100% being equal to the reference year.",
      "label": "SHS table",
      "type": "text/tab-separated-values[]",
      "weight": 2
    },
    "SHI>habitatChange_ESA.yml@9|habitat_change_map": {
      "description": "Map showing habitat change between the start and end year time points. A value of 1, 2, and 3 represents habitat loss, habitat gain, and no change in habitat, respectively.",
      "label": "Habitat change map",
      "type": "image/tiff;application=geotiff",
      "weight": 3
    },
    "SHI>habitatChange_ESA.yml@9|raster": {
      "description": "Rasters of land cover data for each time point.",
      "label": "Habitat per time point",
      "type": "image/tiff;application=geotiff[]",
      "weight": 4
    },
    "data>getRangeMap.yml@14|sf_range_map": {
      "description": "Polygon with expected area for the species.",
      "label": "Expert range map",
      "type": "application/geopackage+sqlite3[]",
      "weight": 5
    },
    "SHI>calculateSHI.yml@43|df_shi": {
      "description": "Table with SHI and Steward’s SHI values for the complete area of study.",
      "label": "SHI table",
      "type": "text/tab-separated-values",
      "weight": 6
    },
    "SHI>calculateSHI.yml@43|img_shi_timeseries": {
      "description": "Figure showing a time series of SHI values for each time step, 100% being equal to the reference year.",
      "label": "SHI time series",
      "type": "image/png",
      "weight": 7
    },
    "SHI>calculateSHI.yml@43|img_w_shi_timeseries": {
      "description": "Figure showing a time series of Steward’s SHI values for each time step. This is weighted by the proportion between the area of habitat for the study area and the total range map of the species. The reference year will start at the proportion of area of habitat in the study area. For example, if half of the species habitat is covered by the study area, the reference year’s value will be 50%.",
      "label": "Steward’s SHI time series",
      "type": "image/png",
      "weight": 8
    }
  },
  "metadata": {
    "name": "SHI with ESA",
    "description": "This pipeline calculates the Species Habitat Score (SHS) and the Species Habitat Index (SHI) for selected  species, following the methodology proposed by Jetz et al. (2022) (link). The SHS consists of two  components: an Area Score, which measures the extent of suitable habitat, and a Connectivity Score,  which assesses the spatial connectedness of that habitat. The SHI is calculated as the average of these  two scores. Species scores can also be weighted based on the proportion of their habitat area that falls  within the study region, allowing for more regionally relevant assessments. To evaluate habitat change over  time, the pipeline compares layers of land cover data from the European Space Agency (ESA), which serve as  the basis for computing both the Area and Connectivity Scores.",
    "author": [
      {
        "name": "Laetitia Tremblay",
        "email": "laetitia.tremblay@mcgill.ca",
        "identifier": "https://www.linkedin.com/in/laetitia-tremblay-b0619b273/",
        "role": "Pipeline development"
      },
      {
        "name": "Maria Isabel Arce-Plata",
        "identifier": "https://orcid.org/0000-0003-4024-9268",
        "role": "Pipeline development"
      },
      {
        "name": "Guillaume Larocque",
        "email": "guillaume.larocque@mcgill.ca",
        "identifier": "https://orcid.org/0000-0002-5967-9156",
        "role": "Pipeline development"
      },
      {
        "name": "Jaime Burbano-Girón",
        "identifier": "https://orcid.org/0000-0001-6570-439X",
        "role": "Pipeline development"
      },
      {
        "name": "Maria Camila Díaz",
        "role": "Pipeline development"
      },
      {
        "name": "Timothée Poisot",
        "identifier": "https://orcid.org/0000-0002-0735-5184",
        "role": "Pipeline development"
      }
    ],
    "references": [
      {
        "text": "Brooks, T. M., Pimm, S. L., Akçakaya, H. R., Buchanan, G. M., Butchart, S. H. M., Foden, W., Hilton-Taylor, C., Hoffmann, M., Jenkins, C. N., Joppa, L., Li, B. V., Menon, V., Ocampo-Peñuela, N., & Rondinini, C. (2019). Measuring Terrestrial Area of Habitat (AOH) and Its Utility for the IUCN Red List. Trends in Ecology & Evolution, 34(11), 977–986. https://doi.org/10.1016/j.tree.2019.06.009 [https://www.sciencedirect.com/science/article/pii/S0169534719301892?via%3Dihub]"
      },
      {
        "text": "Jetz et al., Species Habitat Index [accessed on 24/8/2022](https://mol.org/indicators/habitat/background)"
      },
      {
        "text": "Jetz, W., McGowan, J., Rinnan, D. S., Possingham, H. P., Visconti, P., O’Donnell, B., & Londoño-Murcia, M. C. (2022). Include biodiversity representation indicators in area-based conservation targets. Nature Ecology & Evolution, 6(2), 123–126. https://doi.org/10.1038/s41559-021-01620-y [https://www.nature.com/articles/s41559-021-01620-y]"
      }
    ],
    "license": "CC BY"
  }
}