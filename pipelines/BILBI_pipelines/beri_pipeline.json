{
  "nodes": [
    {
      "id": "0",
      "type": "io",
      "position": {
        "x": 1577,
        "y": 151.66666666666663
      },
      "data": {
        "descriptionFile": "bilbi_indicators>bilbi_weighted_mean.yml"
      }
    },
    {
      "id": "1",
      "type": "io",
      "position": {
        "x": 1124,
        "y": 427.66666666666663
      },
      "data": {
        "descriptionFile": "data>loadFromStac.yml"
      }
    },
    {
      "id": "2",
      "type": "io",
      "position": {
        "x": 1124,
        "y": 181.66666666666663
      },
      "data": {
        "descriptionFile": "data>loadFromStac.yml"
      }
    },
    {
      "id": "3",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 431.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": "https://stac.geobon.org/"
      }
    },
    {
      "id": "4",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 57.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": "https://stac.geobon.org/"
      }
    },
    {
      "id": "6",
      "type": "output",
      "position": {
        "x": 2246,
        "y": 547.5
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "8",
      "type": "constant",
      "position": {
        "x": 641,
        "y": 508.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text[]",
        "value": [
          "csiro_beri"
        ]
      }
    },
    {
      "id": "9",
      "type": "constant",
      "position": {
        "x": 641,
        "y": 99.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text[]",
        "value": [
          "csiro_denominator"
        ]
      }
    },
    {
      "id": "13",
      "type": "output",
      "position": {
        "x": 1577,
        "y": 582.1666666666666
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "15",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 141.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": null
      }
    },
    {
      "id": "16",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 183.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "17",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 225.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "18",
      "type": "userInput",
      "position": {
        "x": 677,
        "y": 396.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "options",
        "value": "near",
        "options": [
          "near",
          "bilinear",
          "average",
          "mode",
          "cubic",
          "cubicspline",
          "lanczos",
          "rms",
          "min",
          "max",
          "sum",
          "med",
          "q1",
          "q3"
        ]
      }
    },
    {
      "id": "19",
      "type": "userInput",
      "position": {
        "x": 647,
        "y": 350.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "float",
        "value": 1000
      }
    },
    {
      "id": "20",
      "type": "userInput",
      "position": {
        "x": 672,
        "y": 473.66666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "options",
        "value": "first",
        "options": [
          "first",
          "min",
          "max",
          "mean",
          "median"
        ]
      }
    },
    {
      "id": "22",
      "type": "output",
      "position": {
        "x": 1124,
        "y": 12
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "24",
      "type": "userInput",
      "position": {
        "x": 12,
        "y": 366.91666666666663
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "bboxCRS"
      }
    },
    {
      "id": "25",
      "type": "io",
      "position": {
        "x": 455.9624938964844,
        "y": 285.7999954223633
      },
      "data": {
        "descriptionFile": "data>load_polygons.yml"
      }
    },
    {
      "id": "26",
      "type": "constant",
      "position": {
        "x": 99.96249389648438,
        "y": 216.79999542236328
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "options",
        "value": "Country or region",
        "options": [
          "Country or region",
          "WDPA",
          "EEZ"
        ]
      }
    },
    {
      "id": "27",
      "type": "constant",
      "position": {
        "x": 65.96249389648438,
        "y": 307.7999954223633
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "float",
        "value": 0
      }
    }
  ],
  "edges": [
    {
      "source": "3",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "stac_url",
      "id": "reactflow__edge-3-1stac_url"
    },
    {
      "source": "4",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "stac_url",
      "id": "reactflow__edge-4-2stac_url"
    },
    {
      "source": "2",
      "sourceHandle": "rasters",
      "target": "0",
      "targetHandle": "bilbi_denominator",
      "id": "reactflow__edge-2rasters-0bilbi_denominator"
    },
    {
      "source": "1",
      "sourceHandle": "rasters",
      "target": "0",
      "targetHandle": "bilbi_indicator",
      "id": "reactflow__edge-1rasters-0bilbi_indicator"
    },
    {
      "source": "0",
      "sourceHandle": "summarised_values",
      "target": "6",
      "targetHandle": null,
      "id": "reactflow__edge-0summarised_values-6"
    },
    {
      "source": "8",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "collections_items",
      "id": "reactflow__edge-8-1collections_items"
    },
    {
      "source": "9",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "collections_items",
      "id": "reactflow__edge-9-2collections_items"
    },
    {
      "source": "1",
      "sourceHandle": "rasters",
      "target": "13",
      "targetHandle": null,
      "id": "reactflow__edge-1rasters-13"
    },
    {
      "source": "15",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "t0",
      "id": "reactflow__edge-15-2t0"
    },
    {
      "source": "16",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "t1",
      "id": "reactflow__edge-16-2t1"
    },
    {
      "source": "17",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "temporal_res",
      "id": "reactflow__edge-17-2temporal_res"
    },
    {
      "source": "18",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "resampling",
      "id": "reactflow__edge-18-1resampling"
    },
    {
      "source": "18",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "resampling",
      "id": "reactflow__edge-18-2resampling"
    },
    {
      "source": "19",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "spatial_res",
      "id": "reactflow__edge-19-2spatial_res"
    },
    {
      "source": "19",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "spatial_res",
      "id": "reactflow__edge-19-1spatial_res"
    },
    {
      "source": "20",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "aggregation",
      "id": "reactflow__edge-20-2aggregation"
    },
    {
      "source": "20",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "aggregation",
      "id": "reactflow__edge-20-1aggregation"
    },
    {
      "source": "24",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-24-2bbox_crs"
    },
    {
      "source": "24",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-24-1bbox_crs"
    },
    {
      "source": "0",
      "sourceHandle": "time_series_plot",
      "target": "6",
      "targetHandle": null,
      "id": "reactflow__edge-0time_series_plot-6"
    },
    {
      "source": "24",
      "sourceHandle": null,
      "target": "25",
      "targetHandle": "country_region_bbox",
      "id": "reactflow__edge-24-25country_region_bbox"
    },
    {
      "source": "25",
      "sourceHandle": "polygon",
      "target": "2",
      "targetHandle": "study_area",
      "id": "reactflow__edge-25polygon-2study_area"
    },
    {
      "source": "25",
      "sourceHandle": "polygon",
      "target": "1",
      "targetHandle": "study_area",
      "id": "reactflow__edge-25polygon-1study_area"
    },
    {
      "source": "26",
      "sourceHandle": null,
      "target": "25",
      "targetHandle": "polygon_type",
      "id": "reactflow__edge-26-25polygon_type"
    },
    {
      "source": "27",
      "sourceHandle": null,
      "target": "25",
      "targetHandle": "buffer",
      "id": "reactflow__edge-27-25buffer"
    },
    {
      "source": "25",
      "sourceHandle": "polygon",
      "target": "0",
      "targetHandle": "study_area",
      "id": "reactflow__edge-25polygon-0study_area"
    }
  ],
  "inputs": {
    "pipeline@24": {
      "label": "Bounding box and CRS",
      "description": "Select a country/region and a CRS to obtain the associated bounding box. You may also draw/input a custom bounding box along with a CRS.",
      "type": "bboxCRS",
      "example": null,
      "weight": 0
    },
    "data>loadFromStac.yml@1|t0": {
      "description": "Start date for time series layers. Can be in the format YYYY or YYYY-MM-DD. Leave blank if using all available dates.",
      "label": "Start date (optional)",
      "type": "text",
      "example": null,
      "weight": 1
    },
    "data>loadFromStac.yml@1|t1": {
      "description": "End date for time series layers. Can be in the format YYYY or YYYY-MM-DD. Leave blank if using all available dates.",
      "label": "End date (optional)",
      "type": "text",
      "example": null,
      "weight": 2
    },
    "data>loadFromStac.yml@1|temporal_res": {
      "description": "Temporal resolution to use when querying STAC items by date, in the format (\"P\", time interval, and time unit, e.g. \"P1Y\" is yearly, \"P1M\" is monthly, and \"P1D\" is daily). Leave blank if not querying by date. If the temporal resolution is coarser than the temporal resolution of the time series, the layers will be aggregated with the aggregation method chosen below.",
      "label": "Temporal resolution (optional)",
      "type": "text",
      "example": null,
      "weight": 3
    },
    "pipeline@19": {
      "label": "Spatial resolution",
      "description": "Integer, spatial resolution of the rasters in the same units as the coordinate reference system (meters for projected reference systems and degrees for reference systems in lat long).\n\nLeave blank to use the original spatial resolution of the layers. If left blank, CRS must be EPSG:4326.",
      "type": "float",
      "example": null,
      "weight": 4
    },
    "pipeline@18": {
      "label": "Resampling method",
      "description": "Resampling method used when rescaling and/or reprojecting the raster layers. See [gdalwarp](https://gdal.org/en/latest/programs/gdalwarp.html) for description.\n\nWill be ignored if not resampling.",
      "type": "options",
      "example": "near",
      "options": [
        "near",
        "bilinear",
        "average",
        "mode",
        "cubic",
        "cubicspline",
        "lanczos",
        "rms",
        "min",
        "max",
        "sum",
        "med",
        "q1",
        "q3"
      ],
      "weight": 5
    },
    "pipeline@20": {
      "label": "Aggregation method",
      "description": "Method used to aggregate items when layers combining over time.\n\nWill be ignored if not aggregating.",
      "type": "options",
      "example": "first",
      "options": [
        "first",
        "min",
        "max",
        "mean",
        "median"
      ],
      "weight": 6
    }
  },
  "outputs": {
    "data>loadFromStac.yml@1|rasters": {
      "description": "Output raster files in geotiff format.",
      "label": "Raster layers of indicator for each year",
      "type": "image/tiff;application=geotiff[]",
      "weight": 0
    },
    "bilbi_indicators>bilbi_weighted_mean.yml@0|summarised_values": {
      "description": "Yearly weighted geometric mean of BERI in the study area polygon.\n\n\nThe value, ranging from 0 to 1 represents the proportion of connected habitat expected to remain under climate change compared to what would exist without human modification or climate change.",
      "label": "BERI summary",
      "type": "text/csv",
      "weight": 1
    },
    "bilbi_indicators>bilbi_weighted_mean.yml@0|time_series_plot": {
      "description": "Plot of the geometric mean of the indicator over time in the study area of interest",
      "label": "Time series plot",
      "type": "image/png",
      "weight": 2
    }
  },
  "metadata": {
    "name": "Bioclimatic Ecosystem Resilience Index (BERI)",
    "description": "\n## Introduction\nCSIRO Bioclimatic Ecosystem Resilience Index (BERI v2) is a global 30 arc-second product for the years 2000, 2005, 2010, 2015 and 2020. BERI measures the capacity of natural ecosystems to retain species diversity in the face of climate change, as a function of ecosystem area, connectivity and integrity. The indicator assesses the extent to which any given spatial configuration of natural habitat across a landscape will promote or hinder climate-induced shifts in biological distributions. It does this by analyzing the functional connectivity of each grid-cell of natural habitat to areas of habitat in the surrounding landscape which are projected to support a similar assemblage of species under climate change to that currently associated with the cell of interest. The indicator can then be aggregated and reported by any desired spatial unit â€“ e.g. an ecosystem type, a country, or the entire planet.\nThis pipeline calculates a weighted geometric mean of the BERI indicator over a region of interest.  The code to calculate the weighted mean was adapted from the \"Calculating weighted geometric means of  CSIRO BILBI indicator\" script on the  [CSIRO data access portal](https://doi.org/10.25919/4vvz-4j96).\n## Uses\nThe BERI can be used to monitor and report past-to-present trends in the capacity of ecosystems to retain species diversity in the face of ongoing climate change by repeatedly recalculating the indicator using best-available mapping of ecosystem condition or integrity observed at multiple points in time, e.g. for different years. It can also serve as a leading indicator for assessing the contribution that proposed or implemented area-based actions are expected to make to enhancing the present capacity of ecosystems to retain species diversity, thereby providing a foundation for strategic prioritisation of such actions by countries.\n## Pipeline limitations\n- BERI is a modeled layer, therefore there are greater uncertainties in areas with less data.  Interpret the results with caution.",
    "author": [
      {
        "name": "Jory Griffith",
        "email": "jory.griffith@mcgill.ca",
        "identifier": "https://orcid.org/0000-0001-6020-6690"
      }
    ],
    "license": "CC-BY-NC",
    "references": [
      {
        "text": "Harwood et al. 2022",
        "doi": "https://doi.org/10.25919/4vvz-4j96"
      }
    ]
  }
}