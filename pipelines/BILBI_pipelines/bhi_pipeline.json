{
  "nodes": [
    {
      "id": "0",
      "type": "io",
      "position": {
        "x": 1587,
        "y": 275
      },
      "data": {
        "descriptionFile": "bilbi_indicators>bilbi_weighted_mean.yml"
      }
    },
    {
      "id": "1",
      "type": "io",
      "position": {
        "x": 1130.620049667487,
        "y": 49.34498758312827
      },
      "data": {
        "descriptionFile": "data>loadFromStac.yml"
      }
    },
    {
      "id": "2",
      "type": "io",
      "position": {
        "x": 1124,
        "y": 305
      },
      "data": {
        "descriptionFile": "data>loadFromStac.yml"
      }
    },
    {
      "id": "3",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 23
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": "https://stac.geobon.org/"
      }
    },
    {
      "id": "4",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 207
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": "https://stac.geobon.org/"
      }
    },
    {
      "id": "6",
      "type": "output",
      "position": {
        "x": 2176,
        "y": 376.5
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "7",
      "type": "output",
      "position": {
        "x": 2176,
        "y": 329.5
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "8",
      "type": "constant",
      "position": {
        "x": 641,
        "y": 65
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text[]",
        "value": [
          "csiro_bhi"
        ]
      }
    },
    {
      "id": "9",
      "type": "constant",
      "position": {
        "x": 641,
        "y": 319
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text[]",
        "value": [
          "csiro_denominator"
        ]
      }
    },
    {
      "id": "13",
      "type": "output",
      "position": {
        "x": 1587,
        "y": 22.5
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "15",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 361
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text",
        "value": null
      }
    },
    {
      "id": "16",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 403
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "17",
      "type": "constant",
      "position": {
        "x": 651,
        "y": 445
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "text"
      }
    },
    {
      "id": "18",
      "type": "userInput",
      "position": {
        "x": 677,
        "y": 249
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "options",
        "value": "near",
        "options": [
          "near",
          "bilinear",
          "average",
          "mode",
          "cubic",
          "cubicspline",
          "lanczos",
          "rms",
          "min",
          "max",
          "sum",
          "med",
          "q1",
          "q3"
        ]
      }
    },
    {
      "id": "19",
      "type": "userInput",
      "position": {
        "x": 647,
        "y": 172
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "float",
        "value": 1000
      }
    },
    {
      "id": "20",
      "type": "userInput",
      "position": {
        "x": 672,
        "y": 284
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "options",
        "value": "first",
        "options": [
          "first",
          "min",
          "max",
          "mean",
          "median"
        ]
      }
    },
    {
      "id": "21",
      "type": "io",
      "position": {
        "x": 445.3799503325131,
        "y": 559.8205463423566
      },
      "data": {
        "descriptionFile": "data>getCountryPolygon.yml"
      }
    },
    {
      "id": "22",
      "type": "output",
      "position": {
        "x": 1124,
        "y": 571
      },
      "data": {
        "label": "Output"
      }
    },
    {
      "id": "23",
      "type": "userInput",
      "position": {
        "x": 12,
        "y": 468.25
      },
      "dragHandle": ".dragHandle",
      "data": {
        "type": "bboxCRS"
      }
    }
  ],
  "edges": [
    {
      "source": "3",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "stac_url",
      "id": "reactflow__edge-3-1stac_url"
    },
    {
      "source": "4",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "stac_url",
      "id": "reactflow__edge-4-2stac_url"
    },
    {
      "source": "2",
      "sourceHandle": "rasters",
      "target": "0",
      "targetHandle": "bilbi_denominator",
      "id": "reactflow__edge-2rasters-0bilbi_denominator"
    },
    {
      "source": "1",
      "sourceHandle": "rasters",
      "target": "0",
      "targetHandle": "bilbi_indicator",
      "id": "reactflow__edge-1rasters-0bilbi_indicator"
    },
    {
      "source": "0",
      "sourceHandle": "summarised_values",
      "target": "6",
      "targetHandle": null,
      "id": "reactflow__edge-0summarised_values-6"
    },
    {
      "source": "0",
      "sourceHandle": "time_series_plot",
      "target": "7",
      "targetHandle": null,
      "id": "reactflow__edge-0time_series_plot-7"
    },
    {
      "source": "8",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "collections_items",
      "id": "reactflow__edge-8-1collections_items"
    },
    {
      "source": "9",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "collections_items",
      "id": "reactflow__edge-9-2collections_items"
    },
    {
      "source": "1",
      "sourceHandle": "rasters",
      "target": "13",
      "targetHandle": null,
      "id": "reactflow__edge-1rasters-13"
    },
    {
      "source": "15",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "t0",
      "id": "reactflow__edge-15-2t0"
    },
    {
      "source": "16",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "t1",
      "id": "reactflow__edge-16-2t1"
    },
    {
      "source": "17",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "temporal_res",
      "id": "reactflow__edge-17-2temporal_res"
    },
    {
      "source": "18",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "resampling",
      "id": "reactflow__edge-18-1resampling"
    },
    {
      "source": "18",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "resampling",
      "id": "reactflow__edge-18-2resampling"
    },
    {
      "source": "19",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "spatial_res",
      "id": "reactflow__edge-19-2spatial_res"
    },
    {
      "source": "19",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "spatial_res",
      "id": "reactflow__edge-19-1spatial_res"
    },
    {
      "source": "20",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "aggregation",
      "id": "reactflow__edge-20-2aggregation"
    },
    {
      "source": "20",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "aggregation",
      "id": "reactflow__edge-20-1aggregation"
    },
    {
      "source": "21",
      "sourceHandle": "country",
      "target": "22",
      "targetHandle": null,
      "id": "reactflow__edge-21country-22"
    },
    {
      "source": "21",
      "sourceHandle": "region",
      "target": "22",
      "targetHandle": null,
      "id": "reactflow__edge-21region-22"
    },
    {
      "source": "21",
      "sourceHandle": "country_region_polygon",
      "target": "2",
      "targetHandle": "study_area",
      "id": "reactflow__edge-21country_region_polygon-2study_area"
    },
    {
      "source": "21",
      "sourceHandle": "country_region_polygon",
      "target": "1",
      "targetHandle": "study_area",
      "id": "reactflow__edge-21country_region_polygon-1study_area"
    },
    {
      "source": "21",
      "sourceHandle": "country_region_polygon",
      "target": "0",
      "targetHandle": "study_area",
      "id": "reactflow__edge-21country_region_polygon-0study_area"
    },
    {
      "source": "23",
      "sourceHandle": null,
      "target": "21",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-23-21bbox_crs"
    },
    {
      "source": "23",
      "sourceHandle": null,
      "target": "2",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-23-2bbox_crs"
    },
    {
      "source": "23",
      "sourceHandle": null,
      "target": "1",
      "targetHandle": "bbox_crs",
      "id": "reactflow__edge-23-1bbox_crs"
    }
  ],
  "inputs": {
    "pipeline@23": {
      "label": "Bounding box and CRS",
      "description": "Select a country/region and a CRS to obtain the associated bounding box. You may also draw/input a custom bounding box along with a CRS.",
      "type": "bboxCRS",
      "example": null,
      "weight": 0
    },
    "data>loadFromStac.yml@1|t0": {
      "description": "Start date for time series layers. Can be in the format YYYY or YYYY-MM-DD. Leave blank if using all available dates.",
      "label": "Start date (optional)",
      "type": "text",
      "example": null,
      "weight": 1
    },
    "data>loadFromStac.yml@1|t1": {
      "description": "End date for time series layers. Can be in the format YYYY or YYYY-MM-DD. Leave blank if using all available dates.",
      "label": "End date (optional)",
      "type": "text",
      "example": null,
      "weight": 2
    },
    "data>loadFromStac.yml@1|temporal_res": {
      "description": "Temporal resolution to use when querying STAC items by date, in the format (\"P\", time interval, and time unit, e.g. \"P1Y\" is yearly, \"P1M\" is monthly, and \"P1D\" is daily). Leave blank if not querying by date. If the temporal resolution is coarser than the temporal resolution of the time series, the layers will be aggregated with the aggregation method chosen below.",
      "label": "Temporal resolution (optional)",
      "type": "text",
      "example": null,
      "weight": 3
    },
    "pipeline@19": {
      "label": "Spatial resolution",
      "description": "Integer, spatial resolution of the rasters in the same units as the coordinate reference system (meters for projected reference systems and degrees for reference systems in lat long).\n\nLeave blank to use the original spatial resolution of the layers. If left blank, CRS must be EPSG:4326.",
      "type": "float",
      "example": null,
      "weight": 4
    },
    "pipeline@18": {
      "label": "Resampling method",
      "description": "Resampling method used when rescaling and/or reprojecting the raster layers. See [gdalwarp](https://gdal.org/en/latest/programs/gdalwarp.html) for description.\n\nWill be ignored if not resampling.",
      "type": "options",
      "example": "near",
      "options": [
        "near",
        "bilinear",
        "average",
        "mode",
        "cubic",
        "cubicspline",
        "lanczos",
        "rms",
        "min",
        "max",
        "sum",
        "med",
        "q1",
        "q3"
      ],
      "weight": 5
    },
    "pipeline@20": {
      "label": "Aggregation method",
      "description": "Method used to aggregate items when layers combining over time.\n\nWill be ignored if not aggregating.",
      "type": "options",
      "example": "first",
      "options": [
        "first",
        "min",
        "max",
        "mean",
        "median"
      ],
      "weight": 6
    }
  },
  "outputs": {
    "data>loadFromStac.yml@1|rasters": {
      "description": "Output raster files in geotiff format.",
      "label": "Raster indicator layers for each year",
      "type": "image/tiff;application=geotiff[]",
      "weight": 0
    },
    "data>getCountryPolygon.yml@21|country": {
      "description": "Name of country of interest",
      "label": "Country",
      "type": "text",
      "weight": 1
    },
    "data>getCountryPolygon.yml@21|region": {
      "description": "Name of state/province of interest",
      "label": "Region",
      "type": "text",
      "weight": 2
    },
    "bilbi_indicators>bilbi_weighted_mean.yml@0|summarised_values": {
      "description": "Yearly weighted geometric mean of BHI in the study area polygon.\n\n\nA higher value (closer to 1) indicates that a large proportion of the habitat remains in good condition and is well-connected, leading to a high expectation of species persistence. A lower value indicates that a significant proportion of the original habitat has been lost, degraded, or fragmented, which puts biodiversity at risk.",
      "label": "BHI summary",
      "type": "text/csv",
      "weight": 3
    },
    "bilbi_indicators>bilbi_weighted_mean.yml@0|time_series_plot": {
      "description": "Plot of the geometric mean of the indicator over time in the study area of interest",
      "label": "Time series plot",
      "type": "image/png",
      "weight": 4
    }
  },
  "metadata": {
    "name": "Biodiversity Habitat Index (BHI)",
    "description": "\n## Introduction\nCSIRO Biodiversity Habitat Index (BHI v2) is a global 30 arc-second product for 2000,2005,2010,2015 and 2020. BHI estimates the level of species diversity expected to be retained within any given spatial reporting unit (e.g., a country, a broad ecosystem type, or the entire planet) as a function of the unit’s area, connectivity and integrity of natural ecosystems across it. Results for the indicator can either be expressed as 1) the ‘effective proportion of habitat’ remaining within the unit – adjusting for the effects of the condition and functional connectivity of habitat, and of spatial variation in the species composition of ecological communities (beta diversity); or 2) the effective proportion of habitat that can be translated, through standard species-area analysis, into a prediction of the proportion of species expected to persist (i.e. avoid extinction) over the long term.\n\nThis pipeline calculates a weighted geometric mean of the BHI indicator over a region of interest.  The code to calculate the weighted mean was adapted from the \"Calculating weighted geometric means of  CSIRO BILBI indicator\" script on the  [CSIRO data access portal](https://doi.org/10.25919/tt2t-h452)\n## Uses \nThe BHI is used to monitor and report past-to-present trends in the expected persistence of species diversity by repeatedly recalculating the indicator using best-available mapping of ecosystem condition or integrity observed at multiple points in time, e.g., for different years. A wide variety of data sources can be used for this purpose, spanning spatial scales from global to subnational, and including data assembled by countries for deriving ecosystem condition accounts under the UN SEEA Ecosystem Accounting framework. The BHI can also serve as a leading indicator for assessing the contribution that proposed or implemented area-based actions are expected to make towards enhancing the present capacity of ecosystems to retain species diversity, thereby providing a foundation for strategic prioritisation of such actions by countries.\n## Pipeline limitations\n- BHI is a modeled layer, therefore there are greater uncertainties in areas with less data.  Interpret the results with caution.",
    "author": [
      {
        "name": "Jory Griffith",
        "email": "jory.griffith@mcgill.ca",
        "identifier": "https://orcid.org/0000-0001-6020-6690"
      }
    ],
    "license": "CC-BY-NC",
    "references": [
      {
        "text": "Harwood et al. 2022",
        "doi": "https://doi.org/10.25919/tt2t-h452"
      }
    ]
  }
}